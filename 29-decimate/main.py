# from kk_util import *
# import array
#
# acc = [[-0.88988999999999995882],
# [-0.88646999999999998021],
# [-0.89715999999999995751],
# [-0.89453000000000004732],
# [-0.89270000000000004903],
# [-0.90039000000000002366],
# [-0.88788000000000000256],
# [-0.89519999999999999574],
# [-0.90288999999999997037],
# [-0.90149000000000001354],
# [-0.90917999999999998817],
# [-0.90935999999999994614],
# [-0.90117999999999998106],
# [-0.90386999999999995126],
# [-0.90417000000000002924],
# ]
#
#
# n = 4
# n_filter = 8
# a = [0.0 for i in range(n_filter+1)]
# b = [0.0 for i in range(n_filter+1)]
# if n == 4:
#     a[0]=1.0000000000000000000000000000000000000000000000000000000000000000000000
#     a[1]=-6.0971129583714169797303839004598557949066162109375000000000000000000000
#     a[2]=16.9346004760360564489474199945107102394104003906250000000000000000000000
#     a[3]=-27.8660382719920320937490032520145177841186523437500000000000000000000000
#     a[4]=29.6304537334959903205344744492322206497192382812500000000000000000000000
#     a[5]=-20.8090923187866643218058015918359160423278808593750000000000000000000000
#     a[6]=9.4142790899313375518886459758505225181579589843750000000000000000000000
#     a[7]=-2.5067378070648831389632960053859278559684753417968750000000000000000000
#     a[8]=0.3006872193662448733419978452729992568492889404296875000000000000000000
#     b[0]=0.0000040359292893478158925114895883012877675355412065982818603515625000
#     b[1]=0.0000322874343147825271400919167064103021402843296527862548828125000000
#     b[2]=0.0001130060201017388449903217084724360574909951537847518920898437500000
#     b[3]=0.0002260120402034776899806434169448721149819903075695037841796875000000
#     b[4]=0.0002825150502543471260283314272498955688206478953361511230468750000000
#     b[5]=0.0002260120402034776899806434169448721149819903075695037841796875000000
#     b[6]=0.0001130060201017388449903217084724360574909951537847518920898437500000
#     b[7]=0.0000322874343147825271400919167064103021402843296527862548828125000000
#     b[8]=0.0000040359292893478158925114895883012877675355412065982818603515625000
# else:
#     print('not implemented yet')
#
# m = 3
# d_prev = zeros(n_filter,m)
# d_now = zeros(n_filter,m)
# N = len(acc)
# x_mean = avg(acc)
# print('x_mean={}'.format(x_mean))
# acc_ = list(acc)
# x = matrix_minus_row(acc_, x_mean)
# # x_mean = mean(x)
# # print('x_mean={}'.format(x_mean))
# y = zeros(N,m)
# N=15
# for i in range(N):
#     for j in range(1):
#         y[i][j] = b[0]*x[i][j] + d_prev[0][j]
#     for k in range(n_filter):
#         for j in range(1):
#             d_now[k][j] =   b[k+1]*x[i][j] - a[k+1]*y[i][j] + d_prev[k+1][j] if k < n_filter-1 else \
#                             b[k+1]*x[i][j] - a[k+1]*y[i][j]
#     d_prev = list(d_now)
#     # if i == 10:
#     #     break
# # D: 0.0,-2.511605e-06
# # D: 0.0,-2.511605e-06
#
# y = matrix_plus_row(y, x_mean)
# for i in range(N):
#     print('{:.20f}, {:.20f}'.format(acc[i][0], y[i][0]))
#
# # yd = [y[4*i] for i in range(int(N/4))]


from kk_util import *
import array
acc=[
[-0.88989,-0.45441,-0.02258],
[-0.88647,-0.45129,-0.01733],
[-0.89716,-0.44934,-0.01324],
[-0.89453,-0.45306,-0.01660],
[-0.89270,-0.45209,-0.01984],
[-0.90039,-0.45514,-0.02087],
[-0.88788,-0.45502,-0.02448],
[-0.89520,-0.45020,-0.02271],
[-0.90289,-0.45593,-0.01843],
[-0.90149,-0.45441,-0.03259],
[-0.90918,-0.45294,-0.04822],
[-0.90936,-0.45416,-0.04559],
[-0.90118,-0.45447,-0.04590],
[-0.90387,-0.45465,-0.04059],
[-0.90417,-0.45380,-0.04156],
[-0.89447,-0.45129,-0.05908],
[-0.89557,-0.45227,-0.05725],
[-0.89990,-0.45154,-0.05334],
[-0.89355,-0.45331,-0.05627],
[-0.89545,-0.45258,-0.06445],
]

n=4
n_filter = 8
a = [0.0 for i in range(n_filter+1)]
b = [0.0 for i in range(n_filter+1)]
if n == 4:
    a[0]=1.0000000000000000000000000000000000000000000000000000000000000000000000
    a[1]=-6.0971129583714169797303839004598557949066162109375000000000000000000000
    a[2]=16.9346004760360564489474199945107102394104003906250000000000000000000000
    a[3]=-27.8660382719920320937490032520145177841186523437500000000000000000000000
    a[4]=29.6304537334959903205344744492322206497192382812500000000000000000000000
    a[5]=-20.8090923187866643218058015918359160423278808593750000000000000000000000
    a[6]=9.4142790899313375518886459758505225181579589843750000000000000000000000
    a[7]=-2.5067378070648831389632960053859278559684753417968750000000000000000000
    a[8]=0.3006872193662448733419978452729992568492889404296875000000000000000000
    b[0]=0.0000040359292893478158925114895883012877675355412065982818603515625000
    b[1]=0.0000322874343147825271400919167064103021402843296527862548828125000000
    b[2]=0.0001130060201017388449903217084724360574909951537847518920898437500000
    b[3]=0.0002260120402034776899806434169448721149819903075695037841796875000000
    b[4]=0.0002825150502543471260283314272498955688206478953361511230468750000000
    b[5]=0.0002260120402034776899806434169448721149819903075695037841796875000000
    b[6]=0.0001130060201017388449903217084724360574909951537847518920898437500000
    b[7]=0.0000322874343147825271400919167064103021402843296527862548828125000000
    b[8]=0.0000040359292893478158925114895883012877675355412065982818603515625000
else:
    print('not implemented yet')

N = len(acc)
m = len(acc[0])

d_prev = zeros(n_filter,m)
d_now = zeros(n_filter,m)
y = zeros(N,m)

x_mean = mean(acc)
print('x_mean={}'.format(x_mean))
x = matrix_minus_row(acc, x_mean)

N=15
for i in range(N):
    for j in range(m):
        y[i][j] = b[0]*x[i][j] + d_prev[0][j]
        for k in range(n_filter):
            d_now[k][j] =   b[k+1]*x[i][j] - a[k+1]*y[i][j] + d_prev[k+1][j] if k < n_filter-1 else \
                            b[k+1]*x[i][j] - a[k+1]*y[i][j]
    d_prev = list(d_now)

y = matrix_plus_row(y, x_mean)
for i in range(N):
    print('{:.20f}, {:.20f}'.format(acc[i][0], y[i][0]))
    # print('{:.20f}, {:.20f}, {:.20f}'.format(y[i][0], y[i][1], y[i][2]))


# yd = [y[4*i] for i in range(int(N/4))]
